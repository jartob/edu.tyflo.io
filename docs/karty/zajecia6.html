<!DOCTYPE html><html lang="pl"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ZajÄ™cia 06 â€“ Trening sÅ‚uchowy (z lektorem)</title>
<style>:root{--scale:1.0;--accent:#66BB6A}*{box-sizing:border-box}body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:#000;color:#fff;font-size:calc(18px*var(--scale))}
.wrap{max-width:900px;margin:0 auto;padding:20px}.panel{border:2px solid var(--accent);border-radius:16px;background:#0e0e0e;padding:16px;margin:12px 0}
.controls{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:10px}input,select,button{width:100%;padding:12px 14px;background:#000;color:#fff;border:2px solid var(--accent);border-radius:12px}
button.primary{background:var(--accent);color:#000;font-weight:800;cursor:pointer}.display{border:3px dashed var(--accent);border-radius:16px;min-height:22vh;display:flex;align-items:center;justify-content:center;padding:16px;text-align:center}
.big{font-weight:900;font-size:calc(1.2rem*var(--scale))}.stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:10px}
.stat{background:#0b0b0b;border:1px solid #333;border-radius:12px;padding:10px;color:#ddd}.note{color:#a5d6a7}</style></head><body>
<main class="wrap"><h1>ðŸŽ§ ZajÄ™cia 06 â€“ Trening sÅ‚uchowy (niski/wysoki) â€“ z lektorem</h1>
<section class="panel"><div class="controls">
  <div><label>Rundy</label><input id="rounds" type="number" min="3" max="40" value="12"/></div>
  <div><label>Czas tonu (ms)</label><input id="dur" type="number" min="100" max="2000" step="50" value="600"/></div>
  <div><label>Przerwa (ms)</label><input id="isi" type="number" min="150" max="3000" step="50" value="450"/></div>
  <div><label>Lektor</label><select id="tts"><option value="on" selected>WÅ‚Ä…czony</option><option value="off">WyÅ‚Ä…czony</option></select></div>
  <div style="align-self:end"><button id="start" class="primary">START</button></div>
</div>
<div class="display"><div class="big" id="msg">Instrukcja: <b>A = niski (lewy)</b>, <b>L = wysoki (prawy)</b>. Po sygnale wciÅ›nij odpowiedni klawisz.</div></div>
<div class="stats"><div class="stat"><b>OK:</b> <span id="ok">0</span></div><div class="stat"><b>BÅ‚Ä™dy:</b> <span id="err">0</span></div><div class="stat"><b>Runda:</b> <span id="n">0 / 0</span></div></div>
<p class="note">WskazÃ³wka: poproÅ› ucznia o zaÅ‚oÅ¼enie sÅ‚uchawek. Niski â‰ˆ 320 Hz, wysoki â‰ˆ 1200 Hz.</p>
</section></main>
<script>
const $=s=>document.querySelector(s);
let voiceOn=true; $('#tts').addEventListener('change',e=>{voiceOn=e.target.value==='on'; if(!voiceOn&&'speechSynthesis'in window) try{speechSynthesis.cancel();}catch(_){}});
function say(t){ if(!voiceOn||!('speechSynthesis'in window))return; const u=new SpeechSynthesisUtterance(t); u.lang='pl-PL'; u.rate=0.98; try{ speechSynthesis.cancel(); }catch(_){ } speechSynthesis.speak(u); }

const el={start:$('#start'), rounds:$('#rounds'), dur:$('#dur'), isi:$('#isi'), n:$('#n'), msg:$('#msg')};
let st={ total:12, i:0, phase:'idle', target:null, ctx:null };

function beep(type){
  st.ctx = st.ctx || new (window.AudioContext||window.webkitAudioContext)();
  const ctx = st.ctx;
  const o = ctx.createOscillator();
  const g = ctx.createGain();
  o.type='sine';
  o.frequency.value = (type==='low'? 320 : 1200);
  g.gain.value = 0.001;
  o.connect(g); g.connect(ctx.destination);
  o.start();
  const now = ctx.currentTime;
  g.gain.exponentialRampToValueAtTime(0.25, now+0.02);
  g.gain.exponentialRampToValueAtTime(0.001, now + (parseInt(el.dur.value)||600)/1000);
  setTimeout(()=>{ try{o.stop();}catch(_){ } }, parseInt(el.dur.value)||600);
}

function next(){
  st.i++; el.n.textContent = `${Math.min(st.i, st.total)} / ${st.total}`;
  if(st.i>st.total){ st.phase='idle'; el.msg.innerHTML='Koniec Ä‡wiczenia. Åšwietna robota!'; say('Koniec Ä‡wiczenia. Brawo.'); return; }
  st.phase='listen';
  st.target = Math.random()<.5 ? 'low' : 'high';
  el.msg.textContent = 'Uwaga, sygnaÅ‚...';
  say('Uwaga, sygnaÅ‚');
  setTimeout(()=>{ beep(st.target); setTimeout(()=>{ st.phase='input'; el.msg.innerHTML='Odpowiedz: A = niski, L = wysoki'; say('Odpowiedz'); }, parseInt(el.dur.value)||600); }, parseInt(el.isi.value)||450);
}

function start(){
  st.total = Math.max(3, Math.min(40, parseInt(el.rounds.value)||12));
  st.i=0; $('#ok').textContent='0'; $('#err').textContent='0'; el.msg.innerHTML='Start. Po sygnale odpowiedz: A = niski, L = wysoki.'; say('Start. Po sygnale odpowiedz: A niski, L wysoki.');
  next();
}

function press(side){
  if(st.phase!=='input') return;
  const correct = (st.target==='low' && side==='left') || (st.target==='high' && side==='right');
  if(correct){ $('#ok').textContent=String(parseInt($('#ok').textContent||'0')+1); el.msg.textContent='Dobrze!'; say('Dobrze'); }
  else { $('#err').textContent=String(parseInt($('#err').textContent||'0')+1); el.msg.textContent='BÅ‚Ä…d'; say('BÅ‚Ä…d'); }
  next();
}

window.addEventListener('keydown',e=>{
  const k=e.key.toLowerCase();
  if(k==='a') press('left');
  if(k==='l') press('right');
});

el.start.addEventListener('click', start);
</script></body></html>